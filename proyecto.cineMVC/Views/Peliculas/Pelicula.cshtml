@model IEnumerable<proyecto.Cine.Logica.Modelo.Cartelera>
@{
    ViewBag.Title = "ReservarPelicula";
    Layout = "~/Views/Shared/_LayoutAdministrar.cshtml";
}

<h2>Reservar ON-LINE - Elegir funci&oacute;n</h2>

<h5>Pel&iacute;cula: @ViewBag.NombrePelicula</h5>
<br />
<br />
<form action="/Pelicula/ConfirmarReserva" method="post">
    @foreach (var p in Model)
    {
      <label>Sede:</label> @Html.DisplayFor(modelS => p.Sede.Nombre)
      <label>Versi&oacute;n:</label> @Html.DisplayFor(modelS => p.Versione.Nombre)
      
        var dia="";
        if(p.Lunes == true)
        {
           dia="Lunes";
        }
        if(p.Martes == true)
        {
            dia="Martes";
        }
        if(p.Miercoles == true)
        {
            dia="Miercoles";
        }
        if(p.Jueves == true)
        {
            dia="Jueves";
        }
        if(p.Viernes == true)
        {
            dia="Viernes";
        }
        if(p.Sabado == true)
        {
            dia="Sabado";
        }
        if(p.Domingo == true)
        {
            dia="Domingo";
        }  
    
    <label>D&iacute;a:</label> @(dia)   <br />
    <label>Horarios disponibles:</label> <select id="@p.IdCartelera" name="@p.IdCartelera" class="browser-default">
                                            <option value="@p.HoraInicio:00">@p.HoraInicio:00</option>
                                                
                                            @{  
                                                var flag=0;
                                                double intervalo = 0.5;
                                                double duracionPelicula = Convert.ToInt32(p.Pelicula.Duracion)/60; // Duracion en hs de la pelicula
                                                double horario = Convert.ToInt32(p.HoraInicio); // Horario inicial de la pelicula
        
                                                while(flag == 0)
                                                {   
                                                    horario = horario + duracionPelicula + intervalo;                                                                                                                              
                                                               
                                                    if(horario > 24) {
                                                        flag = 1;
                                                    } else {
                                                        if(horario % 1 == 0){ 
                                                            <option value="@horario:00">@horario:00 </option> // Si es entero el horario sera "hh:00"           
                                                        } else {
                                                            <option value="@Math.Truncate(horario):30">@Math.Truncate(horario):30 </option> // Si tiene parte decimal => "hh:30"
                                                        }
                                                    }
                                                }
                                             }
                                            
                                            
                                         </select>
    <label>&nbsp;&nbsp;&nbsp;</label>
    <button class="btn waves-effect waves-light" type="button" onclick="confirmarReserva(@p.IdCartelera)">
        Reservar
        <i class="material-icons right">send</i>
    </button>
    <br /><br />

    }                              
    <br />
    <br />
</form>
